<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>JEFFIN DESIGNER - Painel de Vendas</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    :root {
      --primary: #f97316;
      --primary-dark: #ea580c;
      --primary-light: #fdba74;
      --secondary: #1e293b;
      --light: #fff7ed;
      --dark: #1c1917;
      --success: #16a34a;
      --warning: #d97706;
      --danger: #dc2626;
      --info: #2563eb;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }
    body {
      background-color: var(--light);
      color: var(--dark);
    }
    header {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
      color: white;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .logo-icon {
      width: 50px;
      height: 50px;
      background: white;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.8rem;
      color: var(--primary-dark);
      position: relative;
      overflow: hidden;
    }
    .logo-icon span {
      position: relative;
      z-index: 2;
    }
    .logo-icon:after {
      content: "";
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      background: linear-gradient(45deg, transparent 45%, var(--primary-light) 50%, transparent 55%);
      opacity: 0.3;
    }
    header h1 {
      font-size: 1.8rem;
      font-weight: 600;
    }
    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-dark);
      font-weight: bold;
    }
    nav {
      background-color: white;
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 15px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    nav button {
      background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
      color: white;
      border: none;
      padding: 12px 25px;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-weight: 500;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    nav button:hover {
      background: linear-gradient(to bottom, var(--primary-dark), var(--primary));
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }
    .tab {
      display: none;
      padding: 25px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .active {
      display: block;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }
    .card {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border-left: 4px solid var(--primary);
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .label {
      font-weight: 500;
      color: var(--primary-dark);
      font-size: 1rem;
      margin-bottom: 5px;
    }
    .value {
      font-size: 2rem;
      font-weight: 600;
      color: var(--secondary);
    }
    .value-small {
      font-size: 1.5rem;
    }
    .trend {
      display: flex;
      align-items: center;
      font-size: 0.9rem;
      margin-top: 5px;
    }
    .trend.up {
      color: var(--success);
    }
    .trend.down {
      color: var(--danger);
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 15px;
      font-size: 1rem;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      resize: vertical;
      transition: border-color 0.3s ease;
    }
    textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.2);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 25px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #e2e8f0;
      padding: 12px 15px;
      text-align: left;
    }
    th {
      background-color: var(--primary-dark);
      color: white;
      font-weight: 500;
    }
    tr:nth-child(even) {
      background-color: #fff7ed;
    }
    tr:hover {
      background-color: #ffedd5;
    }
    .status {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    .status.pending {
      background-color: #fef3c7;
      color: var(--warning);
    }
    .status.completed {
      background-color: #dcfce7;
      color: var(--success);
    }
    .status.canceled {
      background-color: #fee2e2;
      color: var(--danger);
    }
    input[type="text"], 
    input[type="number"], 
    input[type="date"],
    input[type="email"],
    select {
      padding: 10px 12px;
      margin: 8px 0;
      width: 100%;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      transition: all 0.3s ease;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.2);
    }
    .form-row {
      margin-bottom: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .section-title {
      font-size: 1.1rem;
      margin: 20px 0 10px;
      color: var(--primary-dark);
      font-weight: 500;
      display: block;
    }
    canvas {
      max-width: 100%;
      margin-top: 30px;
    }
    button {
      background: linear-gradient(to bottom, var(--primary), var(--primary-dark));
      color: white;
      border: none;
      padding: 12px 25px;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-weight: 500;
      margin-top: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    button:hover {
      background: linear-gradient(to bottom, var(--primary-dark), var(--primary));
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }
    button.secondary {
      background: white;
      color: var(--primary-dark);
      border: 1px solid var(--primary);
    }
    button.secondary:hover {
      background: #ffedd5;
    }
    button.danger {
      background: linear-gradient(to bottom, var(--danger), #b91c1c);
    }
    button.danger:hover {
      background: linear-gradient(to bottom, #b91c1c, var(--danger));
    }
    button.info {
      background: linear-gradient(to bottom, var(--info), #1e40af);
    }
    button.info:hover {
      background: linear-gradient(to bottom, #1e40af, var(--info));
    }
    .small-btn {
      padding: 6px 12px;
      font-size: 0.8rem;
    }
    #listaAnotacoes {
      margin-top: 20px;
    }
    .anotacao {
      background-color: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      border-left: 3px solid var(--primary);
      position: relative;
    }
    .anotacao-data {
      font-size: 0.8rem;
      color: #64748b;
      margin-bottom: 5px;
    }
    .anotacao-conteudo {
      margin-bottom: 10px;
    }
    .anotacao-acoes {
      position: absolute;
      top: 15px;
      right: 15px;
      display: flex;
      gap: 5px;
    }
    #resultadoFinanceiro {
      margin-top: 20px;
      padding: 15px;
      background-color: #ffedd5;
      border-radius: 8px;
      border-left: 4px solid var(--primary);
      font-size: 1.2rem;
      color: var(--primary-dark);
    }
    #alertaMensagens {
      margin-top: 15px;
    }
    .alerta-item {
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .alerta-item.info {
      background-color: #dbeafe;
      color: #1e40af;
      border-left: 4px solid #3b82f6;
    }
    .alerta-item.warning {
      background-color: #fef3c7;
      color: #92400e;
      border-left: 4px solid #f59e0b;
    }
    .alerta-item.error {
      background-color: #fee2e2;
      color: #991b1b;
      border-left: 4px solid #ef4444;
    }
    h2 {
      color: var(--primary-dark);
      margin-bottom: 20px;
      font-weight: 600;
      font-size: 1.8rem;
      border-bottom: 2px solid #fed7aa;
      padding-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    h3 {
      color: var(--primary-dark);
      margin: 30px 0 15px;
      font-weight: 500;
      font-size: 1.4rem;
    }
    .search-bar {
      display: flex;
      margin-bottom: 20px;
    }
    .search-bar input {
      flex: 1;
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
    }
    .search-bar button {
      margin-top: 0;
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    .modal-content {
      background-color: white;
      padding: 25px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .modal-title {
      font-size: 1.5rem;
      color: var(--primary-dark);
      font-weight: 600;
    }
    .close-modal {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #64748b;
    }
    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 20px;
      font-size: 0.7rem;
      font-weight: 600;
      background-color: var(--primary-light);
      color: var(--primary-dark);
    }
    .action-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .action-buttons button {
      margin-top: 0;
    }
    .confirmation-modal {
      text-align: center;
    }
    .confirmation-modal .modal-content {
      max-width: 400px;
    }
    .confirmation-modal .buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      margin-top: 20px;
    }
    .empty-state i {
      font-size: 3rem;
      color: var(--primary-light);
      margin-bottom: 15px;
    }
    .empty-state p {
      color: #64748b;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <div class="logo-icon"><span>jf</span></div>
      <h1>JEFFIN DESIGNER</h1>
    </div>
    <div class="user-info">
      <span>Olá, JeffinDzn!</span>
      <div class="user-avatar">JD</div>
    </div>
  </header>

  <nav>
    <button data-tab="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</button>
    <button data-tab="pedidos"><i class="fas fa-shopping-bag"></i> Pedidos</button>
    <button data-tab="clientes"><i class="fas fa-users"></i> Clientes</button>
    <button data-tab="anotacoes"><i class="fas fa-clipboard"></i> Anotações</button>
    <button data-tab="relatorios"><i class="fas fa-chart-pie"></i> Relatórios</button>
  </nav>

  <!-- Dashboard -->
  <div id="dashboard" class="tab active">
    <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
    <div class="dashboard">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="label">Vendas Hoje</div>
            <div id="vendasHoje" class="value">R$ 0,00</div>
          </div>
          <i class="fas fa-shopping-bag" style="font-size: 2rem; color: var(--primary-light);"></i>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div>
            <div class="label">Vendas do Mês</div>
            <div id="vendasMes" class="value">R$ 0,00</div>
          </div>
          <i class="fas fa-calendar-alt" style="font-size: 2rem; color: var(--primary-light);"></i>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div>
            <div class="label">Pedidos Pendentes</div>
            <div id="pedidosPendentes" class="value">0</div>
          </div>
          <i class="fas fa-clock" style="font-size: 2rem; color: var(--primary-light);"></i>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div>
            <div class="label">Clientes Novos</div>
            <div id="clientesNovos" class="value">0</div>
          </div>
          <i class="fas fa-user-plus" style="font-size: 2rem; color: var(--primary-light);"></i>
        </div>
      </div>
    </div>

    <h3><i class="fas fa-chart-line"></i> Desempenho de Vendas</h3>
    <canvas id="graficoVendas"></canvas>

    <h3><i class="fas fa-list"></i> Últimos Pedidos</h3>
    <table id="tabelaUltimosPedidos">
      <thead>
        <tr>
          <th>ID</th>
          <th>Cliente</th>
          <th>Data</th>
          <th>Valor</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <!-- Dados serão preenchidos via JavaScript -->
      </tbody>
    </table>
  </div>

  <!-- Pedidos -->
  <div id="pedidos" class="tab">
    <h2><i class="fas fa-shopping-bag"></i> Pedidos</h2>
    
    <div class="search-bar">
      <input type="text" id="buscaPedidos" placeholder="Buscar pedidos...">
      <button id="btnBuscarPedidos"><i class="fas fa-search"></i> Buscar</button>
    </div>
    
    <div class="action-buttons">
      <button id="btnNovoPedido"><i class="fas fa-plus"></i> Novo Pedido</button>
      <button id="btnLimparPedidos" class="danger"><i class="fas fa-trash"></i> Limpar Pedidos</button>
      <button id="btnExportarPedidos" class="info"><i class="fas fa-file-export"></i> Exportar</button>
    </div>
    
    <table id="tabelaPedidos">
      <thead>
        <tr>
          <th>ID</th>
          <th>Cliente</th>
          <th>Data</th>
          <th>Valor</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <!-- Dados serão preenchidos via JavaScript -->
      </tbody>
    </table>
  </div>

  <!-- Clientes -->
  <div id="clientes" class="tab">
    <h2><i class="fas fa-users"></i> Clientes</h2>
    
    <div class="search-bar">
      <input type="text" id="buscaClientes" placeholder="Buscar clientes...">
      <button id="btnBuscarClientes"><i class="fas fa-search"></i> Buscar</button>
    </div>
    
    <div class="action-buttons">
      <button id="btnNovoCliente"><i class="fas fa-plus"></i> Novo Cliente</button>
      <button id="btnLimparClientes" class="danger"><i class="fas fa-trash"></i> Limpar Clientes</button>
      <button id="btnExportarClientes" class="info"><i class="fas fa-file-export"></i> Exportar</button>
    </div>
    
    <table id="tabelaClientes">
      <thead>
        <tr>
          <th>Nome</th>
          <th>E-mail</th>
          <th>Telefone</th>
          <th>Pedidos</th>
          <th>Última Compra</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <!-- Dados serão preenchidos via JavaScript -->
      </tbody>
    </table>
  </div>

  <!-- Anotações -->
  <div id="anotacoes" class="tab">
    <h2><i class="fas fa-clipboard"></i> Anotações</h2>
    
    <div class="form-row">
      <label class="section-title">Nova Anotação</label>
      <textarea id="novaAnotacao" placeholder="Escreva suas anotações aqui..."></textarea>
      <div class="action-buttons">
        <button id="btnSalvarAnotacao"><i class="fas fa-save"></i> Salvar Anotação</button>
        <button id="btnLimparAnotacoes" class="danger"><i class="fas fa-trash"></i> Limpar Anotações</button>
      </div>
    </div>
    
    <div id="listaAnotacoes">
      <!-- Anotações serão carregadas via JavaScript -->
    </div>
  </div>

  <!-- Relatórios -->
  <div id="relatorios" class="tab">
    <h2><i class="fas fa-chart-pie"></i> Relatórios</h2>
    
    <div class="dashboard">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="label">Total de Vendas</div>
            <div id="totalVendas" class="value">R$ 0,00</div>
          </div>
          <i class="fas fa-money-bill-wave" style="font-size: 2rem; color: var(--primary-light);"></i>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div>
            <div class="label">Pedidos Concluídos</div>
            <div id="pedidosConcluidos" class="value">0</div>
          </div>
          <i class="fas fa-check-circle" style="font-size: 2rem; color: var(--primary-light);"></i>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div>
            <div class="label">Ticket Médio</div>
            <div id="ticketMedio" class="value">R$ 0,00</div>
          </div>
          <i class="fas fa-chart-bar" style="font-size: 2rem; color: var(--primary-light);"></i>
        </div>
      </div>
    </div>
    
    <h3><i class="fas fa-chart-line"></i> Vendas Mensais</h3>
    <canvas id="graficoVendasMensais"></canvas>
    
    <h3><i class="fas fa-chart-pie"></i> Tipos de Projetos</h3>
    <canvas id="graficoProjetos"></canvas>
  </div>

  <!-- Modal Novo Pedido -->
  <div id="modalPedido" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">Novo Pedido</div>
        <button class="close-modal">&times;</button>
      </div>
      <div class="form-group">
        <label class="section-title">Cliente</label>
        <select id="pedidoCliente">
          <option value="">Selecione um cliente</option>
          <!-- Clientes serão carregados via JavaScript -->
        </select>
      </div>
      <div class="form-group">
        <label class="section-title">Tipo de Projeto</label>
        <select id="pedidoTipo">
          <option value="">Selecione o tipo</option>
          <option value="Logo">Logo</option>
          <option value="Identidade Visual">Identidade Visual</option>
          <option value="Site">Site</option>
          <option value="Cartão de Visita">Cartão de Visita</option>
          <option value="Panfleto/Flyer">Panfleto/Flyer</option>
          <option value="Outro">Outro</option>
        </select>
      </div>
      <div class="form-group">
        <label class="section-title">Descrição</label>
        <textarea id="pedidoDescricao" placeholder="Descreva o projeto..."></textarea>
      </div>
      <div class="form-group">
        <label class="section-title">Valor (R$)</label>
        <input type="number" id="pedidoValor" placeholder="0,00" step="0.01">
      </div>
      <div class="form-group">
        <label class="section-title">Prazo de Entrega</label>
        <input type="date" id="pedidoPrazo">
      </div>
      <div class="form-group">
        <label class="section-title">Status</label>
        <select id="pedidoStatus">
          <option value="pending">Pendente</option>
          <option value="completed">Concluído</option>
        </select>
      </div>
      <button id="btnSalvarPedido" style="width: 100%;"><i class="fas fa-save"></i> Salvar Pedido</button>
    </div>
  </div>

  <!-- Modal Novo Cliente -->
  <div id="modalCliente" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">Novo Cliente</div>
        <button class="close-modal">&times;</button>
      </div>
      <div class="form-group">
        <label class="section-title">Nome</label>
        <input type="text" id="clienteNome" placeholder="Nome completo">
      </div>
      <div class="form-group">
        <label class="section-title">E-mail</label>
        <input type="email" id="clienteEmail" placeholder="E-mail">
      </div>
      <div class="form-group">
        <label class="section-title">Telefone</label>
        <input type="text" id="clienteTelefone" placeholder="Telefone">
      </div>
      <div class="form-group">
        <label class="section-title">Observações</label>
        <textarea id="clienteObservacoes" placeholder="Observações sobre o cliente..."></textarea>
      </div>
      <button id="btnSalvarCliente" style="width: 100%;"><i class="fas fa-save"></i> Salvar Cliente</button>
    </div>
  </div>

  <!-- Modal de Confirmação -->
  <div id="modalConfirmacao" class="modal confirmation-modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">Confirmação</div>
        <button class="close-modal">&times;</button>
      </div>
      <p id="confirmacaoMensagem">Tem certeza que deseja realizar esta ação?</p>
      <div class="buttons">
        <button id="btnConfirmarAcao" class="danger"><i class="fas fa-check"></i> Confirmar</button>
        <button id="btnCancelarAcao" class="secondary"><i class="fas fa-times"></i> Cancelar</button>
      </div>
    </div>
  </div>

  <script>
    // Banco de dados no localStorage
    const DB = {
      clientes: JSON.parse(localStorage.getItem('clientes')) || [],
      pedidos: JSON.parse(localStorage.getItem('pedidos')) || [],
      anotacoes: JSON.parse(localStorage.getItem('anotacoes')) || [],
      
      salvar: function() {
        localStorage.setItem('clientes', JSON.stringify(this.clientes));
        localStorage.setItem('pedidos', JSON.stringify(this.pedidos));
        localStorage.setItem('anotacoes', JSON.stringify(this.anotacoes));
      },
      
      // Métodos para clientes
      adicionarCliente: function(cliente) {
        cliente.id = this.clientes.length > 0 ? Math.max(...this.clientes.map(c => c.id)) + 1 : 1;
        cliente.data = new Date().toISOString();
        this.clientes.push(cliente);
        this.salvar();
        return cliente;
      },
      
      atualizarCliente: function(id, dados) {
        const index = this.clientes.findIndex(c => c.id === id);
        if (index !== -1) {
          this.clientes[index] = {...this.clientes[index], ...dados};
          this.salvar();
          return true;
        }
        return false;
      },
      
      removerCliente: function(id) {
        const index = this.clientes.findIndex(c => c.id === id);
        if (index !== -1) {
          this.clientes.splice(index, 1);
          this.salvar();
          return true;
        }
        return false;
      },
      
      limparClientes: function() {
        this.clientes = [];
        this.salvar();
        return true;
      },
      
      // Métodos para pedidos
      adicionarPedido: function(pedido) {
        pedido.id = this.pedidos.length > 0 ? Math.max(...this.pedidos.map(p => p.id)) + 1 : 1;
        pedido.data = new Date().toISOString();
        this.pedidos.push(pedido);
        this.salvar();
        return pedido;
      },
      
      atualizarPedido: function(id, dados) {
        const index = this.pedidos.findIndex(p => p.id === id);
        if (index !== -1) {
          this.pedidos[index] = {...this.pedidos[index], ...dados};
          this.salvar();
          return true;
        }
        return false;
      },
      
      removerPedido: function(id) {
        const index = this.pedidos.findIndex(p => p.id === id);
        if (index !== -1) {
          this.pedidos.splice(index, 1);
          this.salvar();
          return true;
        }
        return false;
      },
      
      limparPedidos: function() {
        this.pedidos = [];
        this.salvar();
        return true;
      },
      
      // Métodos para anotações
      adicionarAnotacao: function(anotacao) {
        anotacao.id = this.anotacoes.length > 0 ? Math.max(...this.anotacoes.map(a => a.id)) + 1 : 1;
        anotacao.data = new Date().toISOString();
        this.anotacoes.push(anotacao);
        this.salvar();
        return anotacao;
      },
      
      atualizarAnotacao: function(id, dados) {
        const index = this.anotacoes.findIndex(a => a.id === id);
        if (index !== -1) {
          this.anotacoes[index] = {...this.anotacoes[index], ...dados};
          this.salvar();
          return true;
        }
        return false;
      },
      
      removerAnotacao: function(id) {
        const index = this.anotacoes.findIndex(a => a.id === id);
        if (index !== -1) {
          this.anotacoes.splice(index, 1);
          this.salvar();
          return true;
        }
        return false;
      },
      
      limparAnotacoes: function() {
        this.anotacoes = [];
        this.salvar();
        return true;
      },
      
      // Exportar dados
      exportarClientes: function() {
        return JSON.stringify(this.clientes, null, 2);
      },
      
      exportarPedidos: function() {
        return JSON.stringify(this.pedidos, null, 2);
      }
    };

    // Variáveis para controle de ações
    let acaoConfirmada = null;
    let acaoAtual = null;

    // Funções auxiliares
    function formatarData(dataString) {
      const data = new Date(dataString);
      return data.toLocaleDateString('pt-BR');
    }

    function formatarMoeda(valor) {
      return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor);
    }

    // Funções para manipulação da UI
    function showTab(id) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      
      if (id === 'dashboard') atualizarDashboard();
      if (id === 'pedidos') carregarPedidos();
      if (id === 'clientes') carregarClientes();
      if (id === 'anotacoes') carregarAnotacoes();
      if (id === 'relatorios') atualizarRelatorios();
    }

    function abrirModalPedido(pedidoId = null) {
      const modal = document.getElementById('modalPedido');
      const selectCliente = document.getElementById('pedidoCliente');
      
      // Limpar o select de clientes e adicionar as opções
      selectCliente.innerHTML = '<option value="">Selecione um cliente</option>';
      DB.clientes.forEach(cliente => {
        const option = document.createElement('option');
        option.value = cliente.id;
        option.textContent = cliente.nome;
        selectCliente.appendChild(option);
      });
      
      // Se for edição, preencher os campos
      if (pedidoId) {
        const pedido = DB.pedidos.find(p => p.id === pedidoId);
        if (pedido) {
          document.querySelector('#modalPedido .modal-title').textContent = 'Editar Pedido';
          document.getElementById('pedidoCliente').value = pedido.clienteId;
          document.getElementById('pedidoTipo').value = pedido.tipo;
          document.getElementById('pedidoDescricao').value = pedido.descricao;
          document.getElementById('pedidoValor').value = pedido.valor;
          document.getElementById('pedidoPrazo').value = pedido.prazo.split('T')[0];
          document.getElementById('pedidoStatus').value = pedido.status;
        }
      } else {
        // Se for novo pedido, limpar os campos
        document.querySelector('#modalPedido .modal-title').textContent = 'Novo Pedido';
        document.getElementById('pedidoCliente').value = '';
        document.getElementById('pedidoTipo').value = '';
        document.getElementById('pedidoDescricao').value = '';
        document.getElementById('pedidoValor').value = '';
        document.getElementById('pedidoPrazo').value = '';
        document.getElementById('pedidoStatus').value = 'pending';
      }
      
      modal.style.display = 'flex';
    }

    function abrirModalCliente(clienteId = null) {
      const modal = document.getElementById('modalCliente');
      
      // Se for edição, preencher os campos
      if (clienteId) {
        const cliente = DB.clientes.find(c => c.id === clienteId);
        if (cliente) {
          document.querySelector('#modalCliente .modal-title').textContent = 'Editar Cliente';
          document.getElementById('clienteNome').value = cliente.nome;
          document.getElementById('clienteEmail').value = cliente.email || '';
          document.getElementById('clienteTelefone').value = cliente.telefone || '';
          document.getElementById('clienteObservacoes').value = cliente.observacoes || '';
        }
      } else {
        // Se for novo cliente, limpar os campos
        document.querySelector('#modalCliente .modal-title').textContent = 'Novo Cliente';
        document.getElementById('clienteNome').value = '';
        document.getElementById('clienteEmail').value = '';
        document.getElementById('clienteTelefone').value = '';
        document.getElementById('clienteObservacoes').value = '';
      }
      
      modal.style.display = 'flex';
    }

    function abrirModalConfirmacao(mensagem, acao) {
      document.getElementById('confirmacaoMensagem').textContent = mensagem;
      acaoAtual = acao;
      document.getElementById('modalConfirmacao').style.display = 'flex';
    }

    function fecharModal() {
      document.querySelectorAll('.modal').forEach(modal => {
        modal.style.display = 'none';
      });
    }

    function salvarPedido(pedidoId = null) {
      const clienteId = parseInt(document.getElementById('pedidoCliente').value);
      const tipo = document.getElementById('pedidoTipo').value;
      const descricao = document.getElementById('pedidoDescricao').value;
      const valor = parseFloat(document.getElementById('pedidoValor').value);
      const prazo = document.getElementById('pedidoPrazo').value;
      const status = document.getElementById('pedidoStatus').value;
      
      if (!clienteId || !tipo || !descricao || isNaN(valor) || !prazo) {
        alert('Por favor, preencha todos os campos obrigatórios.');
        return;
      }
      
      const cliente = DB.clientes.find(c => c.id === clienteId);
      if (!cliente) {
        alert('Cliente não encontrado.');
        return;
      }
      
      const pedidoData = {
        clienteId,
        clienteNome: cliente.nome,
        tipo,
        descricao,
        valor,
        prazo: new Date(prazo).toISOString(),
        status,
        data: new Date().toISOString()
      };
      
      if (pedidoId) {
        // Edição
        if (DB.atualizarPedido(pedidoId, pedidoData)) {
          alert('Pedido atualizado com sucesso!');
          fecharModal();
          carregarPedidos();
          atualizarDashboard();
          atualizarRelatorios();
        } else {
          alert('Erro ao atualizar pedido.');
        }
      } else {
        // Novo pedido
        DB.adicionarPedido(pedidoData);
        alert('Pedido cadastrado com sucesso!');
        fecharModal();
        carregarPedidos();
        atualizarDashboard();
        atualizarRelatorios();
      }
    }

    function salvarCliente(clienteId = null) {
      const nome = document.getElementById('clienteNome').value;
      const email = document.getElementById('clienteEmail').value;
      const telefone = document.getElementById('clienteTelefone').value;
      const observacoes = document.getElementById('clienteObservacoes').value;
      
      if (!nome) {
        alert('Por favor, preencha o nome do cliente.');
        return;
      }
      
      const clienteData = {
        nome,
        email,
        telefone,
        observacoes
      };
      
      if (clienteId) {
        // Edição
        if (DB.atualizarCliente(clienteId, clienteData)) {
          alert('Cliente atualizado com sucesso!');
          fecharModal();
          carregarClientes();
          // Atualizar também os pedidos que podem ter referência ao nome do cliente
          DB.pedidos.forEach(pedido => {
            if (pedido.clienteId === clienteId) {
              pedido.clienteNome = nome;
            }
          });
          DB.salvar();
          carregarPedidos();
        } else {
          alert('Erro ao atualizar cliente.');
        }
      } else {
        // Novo cliente
        DB.adicionarCliente(clienteData);
        alert('Cliente cadastrado com sucesso!');
        fecharModal();
        carregarClientes();
      }
    }

    function salvarAnotacao() {
      const conteudo = document.getElementById('novaAnotacao').value.trim();
      
      if (!conteudo) {
        alert('Por favor, escreva uma anotação.');
        return;
      }
      
      DB.adicionarAnotacao({ conteudo });
      document.getElementById('novaAnotacao').value = '';
      carregarAnotacoes();
    }

    function limparClientes() {
      abrirModalConfirmacao('Tem certeza que deseja limpar TODOS os clientes? Esta ação não pode ser desfeita.', () => {
        if (DB.limparClientes()) {
          alert('Clientes removidos com sucesso!');
          fecharModal();
          carregarClientes();
        }
      });
    }

    function limparPedidos() {
      abrirModalConfirmacao('Tem certeza que deseja limpar TODOS os pedidos? Esta ação não pode ser desfeita.', () => {
        if (DB.limparPedidos()) {
          alert('Pedidos removidos com sucesso!');
          fecharModal();
          carregarPedidos();
          atualizarDashboard();
          atualizarRelatorios();
        }
      });
    }

    function limparAnotacoes() {
      abrirModalConfirmacao('Tem certeza que deseja limpar TODAS as anotações? Esta ação não pode ser desfeita.', () => {
        if (DB.limparAnotacoes()) {
          alert('Anotações removidas com sucesso!');
          fecharModal();
          carregarAnotacoes();
        }
      });
    }

    function exportarClientes() {
      const data = DB.exportarClientes();
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'clientes_jeffin_designer.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    function exportarPedidos() {
      const data = DB.exportarPedidos();
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'pedidos_jeffin_designer.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    // Funções para carregar dados na UI
    function carregarPedidos() {
      const tabela = document.getElementById('tabelaPedidos').querySelector('tbody');
      tabela.innerHTML = '';
      
      if (DB.pedidos.length === 0) {
        tabela.innerHTML = `
          <tr>
            <td colspan="6" class="empty-state">
              <i class="fas fa-box-open"></i>
              <h3>Nenhum pedido encontrado</h3>
              <p>Clique em "Novo Pedido" para adicionar seu primeiro pedido</p>
            </td>
          </tr>
        `;
        return;
      }
      
      DB.pedidos.sort((a, b) => new Date(b.data) - new Date(a.data)).forEach(pedido => {
        const tr = document.createElement('tr');
        
        const statusClass = {
          pending: 'pending',
          completed: 'completed',
          canceled: 'canceled'
        }[pedido.status] || 'pending';
        
        tr.innerHTML = `
          <td>#${pedido.id}</td>
          <td>${pedido.clienteNome}</td>
          <td>${formatarData(pedido.data)}</td>
          <td>${formatarMoeda(pedido.valor)}</td>
          <td><span class="status ${statusClass}">${
            statusClass === 'pending' ? 'Pendente' : 
            statusClass === 'completed' ? 'Concluído' : 'Cancelado'
          }</span></td>
          <td>
            <button class="small-btn ver-pedido" data-id="${pedido.id}"><i class="fas fa-eye"></i></button>
            <button class="small-btn secondary editar-pedido" data-id="${pedido.id}"><i class="fas fa-edit"></i></button>
            <button class="small-btn danger cancelar-pedido" data-id="${pedido.id}"><i class="fas fa-times"></i></button>
          </td>
        `;
        
        tabela.appendChild(tr);
      });

      // Adicionar event listeners aos botões dos pedidos
      document.querySelectorAll('.ver-pedido').forEach(btn => {
        btn.addEventListener('click', function() {
          verDetalhesPedido(parseInt(this.getAttribute('data-id')));
        });
      });

      document.querySelectorAll('.editar-pedido').forEach(btn => {
        btn.addEventListener('click', function() {
          abrirModalPedido(parseInt(this.getAttribute('data-id')));
        });
      });

      document.querySelectorAll('.cancelar-pedido').forEach(btn => {
        btn.addEventListener('click', function() {
          cancelarPedido(parseInt(this.getAttribute('data-id')));
        });
      });
    }

    function carregarClientes() {
      const tabela = document.getElementById('tabelaClientes').querySelector('tbody');
      tabela.innerHTML = '';
      
      if (DB.clientes.length === 0) {
        tabela.innerHTML = `
          <tr>
            <td colspan="6" class="empty-state">
              <i class="fas fa-user-slash"></i>
              <h3>Nenhum cliente encontrado</h3>
              <p>Clique em "Novo Cliente" para adicionar seu primeiro cliente</p>
            </td>
          </tr>
        `;
        return;
      }
      
      DB.clientes.forEach(cliente => {
        // Contar pedidos do cliente
        const totalPedidos = DB.pedidos.filter(p => p.clienteId === cliente.id).length;
        
        // Encontrar última compra
        const pedidosCliente = DB.pedidos.filter(p => p.clienteId === cliente.id);
        const ultimaCompra = pedidosCliente.length > 0 
          ? formatarData(Math.max(...pedidosCliente.map(p => new Date(p.data)))) 
          : 'Nenhuma';
        
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${cliente.nome}</td>
          <td>${cliente.email || '-'}</td>
          <td>${cliente.telefone || '-'}</td>
          <td>${totalPedidos}</td>
          <td>${ultimaCompra}</td>
          <td>
            <button class="small-btn ver-cliente" data-id="${cliente.id}"><i class="fas fa-eye"></i></button>
            <button class="small-btn secondary editar-cliente" data-id="${cliente.id}"><i class="fas fa-edit"></i></button>
          </td>
        `;
        
        tabela.appendChild(tr);
      });

      // Adicionar event listeners aos botões dos clientes
      document.querySelectorAll('.ver-cliente').forEach(btn => {
        btn.addEventListener('click', function() {
          verDetalhesCliente(parseInt(this.getAttribute('data-id')));
        });
      });

      document.querySelectorAll('.editar-cliente').forEach(btn => {
        btn.addEventListener('click', function() {
          abrirModalCliente(parseInt(this.getAttribute('data-id')));
        });
      });
    }

    function carregarAnotacoes() {
      const container = document.getElementById('listaAnotacoes');
      container.innerHTML = '';
      
      if (DB.anotacoes.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-clipboard"></i>
            <h3>Nenhuma anotação encontrada</h3>
            <p>Adicione sua primeira anotação no campo acima</p>
          </div>
        `;
        return;
      }
      
      DB.anotacoes.sort((a, b) => new Date(b.data) - new Date(a.data)).forEach(anotacao => {
        const div = document.createElement('div');
        div.className = 'anotacao';
        
        div.innerHTML = `
          <div class="anotacao-data">${formatarData(anotacao.data)}</div>
          <div class="anotacao-conteudo">${anotacao.conteudo}</div>
          <div class="anotacao-acoes">
            <button class="small-btn danger remover-anotacao" data-id="${anotacao.id}"><i class="fas fa-trash"></i></button>
          </div>
        `;
        
        container.appendChild(div);
      });

      // Adicionar event listeners aos botões de remover anotação
      document.querySelectorAll('.remover-anotacao').forEach(btn => {
        btn.addEventListener('click', function() {
          removerAnotacao(parseInt(this.getAttribute('data-id')));
        });
      });
    }

    function atualizarDashboard() {
      // Vendas hoje
      const hoje = new Date().toISOString().split('T')[0];
      const vendasHoje = DB.pedidos
        .filter(p => p.data.split('T')[0] === hoje && p.status === 'completed')
        .reduce((sum, p) => sum + p.valor, 0);
      document.getElementById('vendasHoje').textContent = formatarMoeda(vendasHoje);
      
      // Vendas do mês
      const mesAtual = new Date().getMonth();
      const anoAtual = new Date().getFullYear();
      const vendasMes = DB.pedidos
        .filter(p => {
          const data = new Date(p.data);
          return data.getMonth() === mesAtual && 
                 data.getFullYear() === anoAtual && 
                 p.status === 'completed';
        })
        .reduce((sum, p) => sum + p.valor, 0);
      document.getElementById('vendasMes').textContent = formatarMoeda(vendasMes);
      
      // Pedidos pendentes
      const pedidosPendentes = DB.pedidos.filter(p => p.status === 'pending').length;
      document.getElementById('pedidosPendentes').textContent = pedidosPendentes;
      
      // Clientes novos (este mês)
      const clientesNovos = DB.clientes.filter(c => {
        const dataCadastro = new Date(c.data || new Date().toISOString());
        return dataCadastro.getMonth() === mesAtual && 
               dataCadastro.getFullYear() === anoAtual;
      }).length;
      document.getElementById('clientesNovos').textContent = clientesNovos;
      
      // Últimos pedidos
      const tabela = document.getElementById('tabelaUltimosPedidos').querySelector('tbody');
      tabela.innerHTML = '';
      
      const ultimosPedidos = DB.pedidos
        .sort((a, b) => new Date(b.data) - new Date(a.data))
        .slice(0, 5);
      
      if (ultimosPedidos.length === 0) {
        tabela.innerHTML = `
          <tr>
            <td colspan="6" class="empty-state">
              <i class="fas fa-box-open"></i>
              <h3>Nenhum pedido encontrado</h3>
            </td>
          </tr>
        `;
      } else {
        ultimosPedidos.forEach(pedido => {
          const tr = document.createElement('tr');
          
          const statusClass = {
            pending: 'pending',
            completed: 'completed',
            canceled: 'canceled'
          }[pedido.status] || 'pending';
          
          tr.innerHTML = `
            <td>#${pedido.id}</td>
            <td>${pedido.clienteNome}</td>
            <td>${formatarData(pedido.data)}</td>
            <td>${formatarMoeda(pedido.valor)}</td>
            <td><span class="status ${statusClass}">${
              statusClass === 'pending' ? 'Pendente' : 
              statusClass === 'completed' ? 'Concluído' : 'Cancelado'
            }</span></td>
            <td>
              <button class="small-btn ver-pedido" data-id="${pedido.id}"><i class="fas fa-eye"></i></button>
            </td>
          `;
          
          tabela.appendChild(tr);
        });
      }

      // Adicionar event listeners aos botões de ver pedido
      document.querySelectorAll('.ver-pedido').forEach(btn => {
        btn.addEventListener('click', function() {
          verDetalhesPedido(parseInt(this.getAttribute('data-id')));
        });
      });
      
      // Atualizar gráfico de vendas
      atualizarGraficoVendas();
    }

    function atualizarRelatorios() {
      // Total de vendas
      const totalVendas = DB.pedidos
        .filter(p => p.status === 'completed')
        .reduce((sum, p) => sum + p.valor, 0);
      document.getElementById('totalVendas').textContent = formatarMoeda(totalVendas);
      
      // Pedidos concluídos
      const pedidosConcluidos = DB.pedidos.filter(p => p.status === 'completed').length;
      document.getElementById('pedidosConcluidos').textContent = pedidosConcluidos;
      
      // Ticket médio
      const ticketMedio = pedidosConcluidos > 0 ? totalVendas / pedidosConcluidos : 0;
      document.getElementById('ticketMedio').textContent = formatarMoeda(ticketMedio);
      
      // Atualizar gráficos
      atualizarGraficoVendasMensais();
      atualizarGraficoProjetos();
    }

    // Funções para gráficos
    function atualizarGraficoVendas() {
      const ctx = document.getElementById('graficoVendas').getContext('2d');
      
      // Se já existe um gráfico, destruir antes de criar um novo
      if (window.graficoVendas) {
        window.graficoVendas.destroy();
      }
      
      // Agrupar vendas por dia (últimos 7 dias)
      const dados = {};
      const hoje = new Date();
      
      for (let i = 6; i >= 0; i--) {
        const data = new Date(hoje);
        data.setDate(hoje.getDate() - i);
        const dataStr = data.toISOString().split('T')[0];
        dados[dataStr] = 0;
      }
      
      DB.pedidos.forEach(pedido => {
        const dataStr = pedido.data.split('T')[0];
        if (dados.hasOwnProperty(dataStr)) {
          dados[dataStr] += pedido.status === 'completed' ? pedido.valor : 0;
        }
      });
      
      const labels = Object.keys(dados).map(data => {
        const d = new Date(data);
        return d.toLocaleDateString('pt-BR', { day: 'numeric', month: 'short' });
      });
      
      window.graficoVendas = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Vendas Diárias',
            data: Object.values(dados),
            borderColor: 'var(--primary-dark)',
            backgroundColor: 'rgba(249, 115, 22, 0.1)',
            borderWidth: 2,
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'top',
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return `R$ ${context.raw.toFixed(2)}`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return `R$ ${value.toFixed(2)}`;
                }
              }
            }
          }
        }
      });
    }

    function atualizarGraficoVendasMensais() {
      const ctx = document.getElementById('graficoVendasMensais').getContext('2d');
      
      if (window.graficoVendasMensais) {
        window.graficoVendasMensais.destroy();
      }
      
      // Agrupar vendas por mês (últimos 12 meses)
      const dados = Array(12).fill(0);
      const hoje = new Date();
      const meses = [];
      
      for (let i = 11; i >= 0; i--) {
        const data = new Date(hoje);
        data.setMonth(hoje.getMonth() - i);
        meses.push(data.toLocaleDateString('pt-BR', { month: 'short' }));
      }
      
      DB.pedidos.forEach(pedido => {
        const dataPedido = new Date(pedido.data);
        const diffMeses = (hoje.getFullYear() - dataPedido.getFullYear()) * 12 + hoje.getMonth() - dataPedido.getMonth();
        
        if (diffMeses >= 0 && diffMeses < 12 && pedido.status === 'completed') {
          dados[11 - diffMeses] += pedido.valor;
        }
      });
      
      window.graficoVendasMensais = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: meses,
          datasets: [{
            label: 'Vendas Mensais',
            data: dados,
            backgroundColor: 'var(--primary)',
            borderColor: 'var(--primary-dark)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'top',
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return `R$ ${context.raw.toFixed(2)}`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return `R$ ${value.toFixed(2)}`;
                }
              }
            }
          }
        }
      });
    }

    function atualizarGraficoProjetos() {
      const ctx = document.getElementById('graficoProjetos').getContext('2d');
      
      if (window.graficoProjetos) {
        window.graficoProjetos.destroy();
      }
      
      // Agrupar por tipo de projeto
      const tipos = {};
      DB.pedidos.forEach(pedido => {
        if (!tipos[pedido.tipo]) {
          tipos[pedido.tipo] = 0;
        }
        tipos[pedido.tipo]++;
      });
      
      // Ordenar por quantidade (maior primeiro)
      const tiposOrdenados = Object.entries(tipos).sort((a, b) => b[1] - a[1]);
      
      const labels = tiposOrdenados.map(t => t[0]);
      const dados = tiposOrdenados.map(t => t[1]);
      
      window.graficoProjetos = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: labels,
          datasets: [{
            data: dados,
            backgroundColor: [
              'var(--primary)',
              'var(--primary-dark)',
              'var(--primary-light)',
              '#fdba74',
              '#f97316',
              '#ea580c'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'right',
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return `${context.label}: ${context.raw} projetos`;
                }
              }
            }
          }
        }
      });
    }

    // Funções para ações
    function verDetalhesPedido(id) {
      const pedido = DB.pedidos.find(p => p.id === id);
      if (pedido) {
        const cliente = DB.clientes.find(c => c.id === pedido.clienteId) || { nome: pedido.clienteNome };
        
        let mensagem = `
          Pedido #${pedido.id}
          Cliente: ${cliente.nome}
          Tipo: ${pedido.tipo}
          Data: ${formatarData(pedido.data)}
          Valor: ${formatarMoeda(pedido.valor)}
          Status: ${pedido.status === 'pending' ? 'Pendente' : pedido.status === 'completed' ? 'Concluído' : 'Cancelado'}
          Prazo: ${formatarData(pedido.prazo)}
          Descrição: ${pedido.descricao}
        `;
        
        if (cliente.telefone) mensagem += `\nTelefone: ${cliente.telefone}`;
        if (cliente.email) mensagem += `\nE-mail: ${cliente.email}`;
        
        alert(mensagem);
      }
    }

    function verDetalhesCliente(id) {
      const cliente = DB.clientes.find(c => c.id === id);
      if (cliente) {
        const pedidosCliente = DB.pedidos.filter(p => p.clienteId === id);
        const totalGasto = pedidosCliente.reduce((sum, p) => sum + p.valor, 0);
        
        let mensagem = `
          Cliente: ${cliente.nome}
          ${cliente.telefone ? `Telefone: ${cliente.telefone}\n` : ''}
          ${cliente.email ? `E-mail: ${cliente.email}\n` : ''}
          Total de Pedidos: ${pedidosCliente.length}
          Total Gasto: ${formatarMoeda(totalGasto)}
          ${cliente.observacoes ? `\nObservações:\n${cliente.observacoes}` : ''}
        `;
        
        alert(mensagem);
      }
    }

    function cancelarPedido(id) {
      if (confirm(`Tem certeza que deseja cancelar o pedido #${id}?`)) {
        if (DB.atualizarPedido(id, { status: 'canceled' })) {
          alert('Pedido cancelado com sucesso!');
          carregarPedidos();
          atualizarDashboard();
          atualizarRelatorios();
        } else {
          alert('Erro ao cancelar pedido.');
        }
      }
    }

    function removerAnotacao(id) {
      if (confirm('Tem certeza que deseja remover esta anotação?')) {
        if (DB.removerAnotacao(id)) {
          carregarAnotacoes();
        }
      }
    }

    function filtrarPedidos() {
      const termo = document.getElementById('buscaPedidos').value.toLowerCase();
      const linhas = document.getElementById('tabelaPedidos').querySelectorAll('tbody tr');
      
      linhas.forEach(linha => {
        const textoLinha = linha.textContent.toLowerCase();
        linha.style.display = textoLinha.includes(termo) ? '' : 'none';
      });
    }

    function filtrarClientes() {
      const termo = document.getElementById('buscaClientes').value.toLowerCase();
      const linhas = document.getElementById('tabelaClientes').querySelectorAll('tbody tr');
      
      linhas.forEach(linha => {
        const textoLinha = linha.textContent.toLowerCase();
        linha.style.display = textoLinha.includes(termo) ? '' : 'none';
      });
    }

    // Inicialização
    document.addEventListener('DOMContentLoaded', function() {
      // Adicionar event listeners para os botões de navegação
      document.querySelectorAll('nav button').forEach(btn => {
        btn.addEventListener('click', function() {
          showTab(this.getAttribute('data-tab'));
        });
      });
      
      // Botões principais
      document.getElementById('btnNovoPedido').addEventListener('click', () => abrirModalPedido());
      document.getElementById('btnNovoCliente').addEventListener('click', () => abrirModalCliente());
      document.getElementById('btnSalvarAnotacao').addEventListener('click', salvarAnotacao);
      document.getElementById('btnBuscarPedidos').addEventListener('click', filtrarPedidos);
      document.getElementById('btnBuscarClientes').addEventListener('click', filtrarClientes);
      document.getElementById('btnLimparClientes').addEventListener('click', limparClientes);
      document.getElementById('btnLimparPedidos').addEventListener('click', limparPedidos);
      document.getElementById('btnLimparAnotacoes').addEventListener('click', limparAnotacoes);
      document.getElementById('btnExportarClientes').addEventListener('click', exportarClientes);
      document.getElementById('btnExportarPedidos').addEventListener('click', exportarPedidos);
      
      // Botões dos modais
      document.getElementById('btnSalvarPedido').addEventListener('click', function() {
        const pedidoId = document.querySelector('#modalPedido .modal-title').textContent === 'Editar Pedido' 
          ? parseInt(document.querySelector('#modalPedido button').getAttribute('data-id') || null) 
          : null;
        salvarPedido(pedidoId);
      });
      
      document.getElementById('btnSalvarCliente').addEventListener('click', function() {
        const clienteId = document.querySelector('#modalCliente .modal-title').textContent === 'Editar Cliente' 
          ? parseInt(document.querySelector('#modalCliente button').getAttribute('data-id') || null) 
          : null;
        salvarCliente(clienteId);
      });
      
      // Botões de confirmação
      document.getElementById('btnConfirmarAcao').addEventListener('click', function() {
        if (acaoAtual) {
          acaoAtual();
        }
        fecharModal();
      });
      
      document.getElementById('btnCancelarAcao').addEventListener('click', fecharModal);
      
      // Botões de fechar modal
      document.querySelectorAll('.close-modal').forEach(btn => {
        btn.addEventListener('click', fecharModal);
      });
      
      // Fechar modal ao clicar fora
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
          if (e.target === this) {
            fecharModal();
          }
        });
      });
      
      // Adicionar dados de exemplo se o banco estiver vazio
      if (DB.clientes.length === 0) {
        DB.adicionarCliente({ nome: 'Maria Silva', email: 'maria@email.com', telefone: '(11) 98765-4321' });
        DB.adicionarCliente({ nome: 'João Santos', email: 'joao@email.com', telefone: '(11) 91234-5678' });
      }
      
      if (DB.pedidos.length === 0) {
        const hoje = new Date().toISOString().split('T')[0];
        DB.adicionarPedido({
          clienteId: 1,
          clienteNome: 'Maria Silva',
          tipo: 'Logo',
          descricao: 'Design de logo para loja de roupas',
          valor: 450,
          prazo: new Date(new Date().setDate(new Date().getDate() + 7)).toISOString(),
          status: 'pending',
          data: hoje
        });
        
        DB.adicionarPedido({
          clienteId: 2,
          clienteNome: 'João Santos',
          tipo: 'Identidade Visual',
          descricao: 'Identidade visual completa para restaurante',
          valor: 1200,
          prazo: new Date(new Date().setDate(new Date().getDate() + 14)).toISOString(),
          status: 'completed',
          data: hoje
        });
      }
      
      if (DB.anotacoes.length === 0) {
        DB.adicionarAnotacao({ conteudo: 'Lembrar de enviar proposta para o cliente João Santos até sexta-feira' });
        DB.adicionarAnotacao({ conteudo: 'Pesquisar referências de design para lojas de moda sustentável' });
      }
      
      // Carregar dados iniciais
      showTab('dashboard');
    });
  </script>
</body>
</html>
